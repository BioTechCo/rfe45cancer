# Datasets

---

- TCGA-BRCA 美國癌症基因體圖譜計畫
- GSE66313 高通量基因表達數據庫

<div style={{ display: 'flex', flexDirection: 'row', alignItems: 'stretch' }}>
    <div style={{ flex: 1, padding: '10px' }}>
        <ImageGallery 
            image="/breast/vp_TCGA_BRCA.png"
            title="TCGA-BRCA Volcano Plot"
            alt="Volcano Plot"
        />
    </div>
    <div style={{ flex: 1, padding: '10px' }}>
        # Description
        By using ChAMP package, a volcano plot can be generated to visualize the differentially methylated regions (DMRs) in the TCGA-BRCA dataset. The volcano plot displays the relationship between the significance (p-value) and the magnitude of change (fold change) of the DMRs.
    </div>
</div>

---

# Dbeta Calculation and DMR Filtering

<div className="methodology-explanation">
  <p>
    Extensive preprocessing of GSE66313 and TCGA-BRCA methylation data was performed using the ChAMP package in R. 
    This involved several critical steps:
  </p>
  
  <ul>
    <li><strong>Quality Control:</strong> Removal of low-quality probes, SNP-related probes, and cross-reactive probes</li>
    <li><strong>Normalization:</strong> BMIQ normalization to adjust for probe type bias (Infinium I vs II)</li>
    <li><strong>Batch Effect Correction:</strong> ComBat algorithm was applied to remove potential batch effects</li>
    <li><strong>Differential Methylation Analysis:</strong> Calculated differentially methylated beta values (Dbeta) between tumor and normal tissues</li>
    <li><strong>Statistical Filtering:</strong> Applied significance threshold of p &lt; 0.05 and absolute Dbeta &gt; 0.2</li>
    <li><strong>Annotation:</strong> DMRs were mapped to genes based on their genomic locations and proximity to TSS (Transcription Start Sites)</li>
  </ul>
  
  <p>
    The resulting differentially methylated regions (DMRs) represent critical epigenetic alterations that may drive breast cancer development and progression.
    Positive Dbeta values indicate hypermethylation in cancer tissues, while negative values represent hypomethylation.
  </p>
</div>

<div style={{ display: 'flex', flexDirection: 'row', marginTop: '20px' }}>
    <div style={{ flex: 1, padding: '10px' }}>
        <DbetaPie dataset="GSE66313" dataset_name="GSE66313" />
    </div>
    <div style={{ flex: 1, padding: '10px' }}>
        <DbetaPie dataset="TCGA_BRCA_20250119" dataset_name="TCGA-BRCA" />
    </div>
</div>


# Joined Data Analysis

<p>
    After filtering the DMRs from both datasets, we joined the two datasets to create a comprehensive dataset for further analysis.
    The joined dataset contains a total of 88 gene, whose similarity was calculated using GO (Gene Ontology) terms.
    The GO terms were obtained from the Ensembl database, and the similarity was calculated using the GOSemSim package in R.
</p>

<div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', marginTop: '20px' }}>
    <div style={{ display: 'flex', flexDirection: 'row', marginTop: '20px' }}>
        <div style={{ flex: 1, padding: '10px' }}>
            <ImageGallery 
                image="/breast/planA/joined/section_5/hierarchical_clustering_simple_sum.png"
                title="Simple Sum Clustering"
                alt="Hierarchical clustering using simple sum"
            />
        </div>
        <div style={{ flex: 1, padding: '10px' }}>
            <ImageGallery 
                image="/breast/planA/joined/section_5/hierarchical_clustering_weighted_sum.png"
                title="Weighted Sum Clustering"
                alt="Hierarchical clustering using weighted sum"
            />
        </div>
        <div style={{ flex: 1, padding: '10px' }}>
            <ImageGallery 
                image="/breast/planA/joined/section_5/hierarchical_clustering_consensus.png"
                title="Consensus Clustering"
                alt="Hierarchical clustering using consensus method"
            />
        </div>
    </div>
    <ImageGallery 
        image="/breast/planA/joined/section_5/hierarchical_clustering_compare.png"
        title="Hierarchical Clustering Comparison"
        alt="Comparison of different clustering methods"
    />
</div>

# Machine Learning

<p>
    consensus clustering was selected as the best clustering method for the joined dataset.
    RFE (Recursive Feature Elimination) was used to select the most important features (genes) for the model.
    Evaluation of the candidate biomarkers was performed using the voting classifier method.
    Bagging were used to generalize the model and reduce overfitting.
</p>

## Top Gene Combinations with Highest Performance

The table below shows the gene combinations that achieved the highest classification performance:

<MdxTable markdown={`| Gene Set | Gene 1 | Gene 2 | Gene 3 | Gene 4 | Accuracy | Recall | Specificity | Precision | F1 Score | AUC |
|---------|--------|--------|--------|--------|----------|--------|-------------|-----------|----------|-----|
| Set 1 | CFTR | CNTNAP5 | PFN3 | SLC2A10 | 0.932 | 1.000 | 0.864 | 0.880 | 0.936 | 0.997 |
| Set 2 | CNTNAP5 | GNG4 | RGS22 | SLC2A2 | 0.932 | 1.000 | 0.864 | 0.880 | 0.936 | 0.996 |`} />
